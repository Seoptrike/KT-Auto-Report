# 📊 KT 매출결의서 자동화 시스템 (v1.1)

KT ACEN 및 AICC 정산 자료를 자동으로 처리하여 매출결의서와 업무실적 보고서를 생성하는 웹 기반 자동화 시스템입니다.

---

## 🆕 v1.1 주요 변경사항

### 🏗️ 아키텍처 전환
- **v1.0**: pywebview 기반 데스크톱 애플리케이션 (.exe)
- **v1.1**: Flask 기반 웹 애플리케이션 (브라우저 접근)

### 📚 라이브러리 최적화
- **제거**: win32com.client (MS Office 의존성 해결)
- **중심**: openpyxl 기반 순수 Python 구현
- **추가**: pandas, numpy를 활용한 데이터 처리 최적화

### 🎯 모듈화 개선
- `services/` 디렉토리로 로직 분리
  - `acen.py`: ACEN 데이터 처리
  - `aicc.py`: AICC 데이터 처리 및 통합
  - `sum.py`: 업무실적 보고서 생성
- 템플릿 기반 웹 UI

### 🚀 배포 방식 변화
- **v1.0**: PyInstaller로 .exe 빌드 + threading/queue 기반 UI
- **v1.1**: 웹서버 배포 + 동기식 처리

---

## 📌 시스템 개요

월별로 반복되는 ACEN 및 AICC 정산 자료를 웹 브라우저를 통해 업로드하면, 자동으로 처리하여 다음과 같은 결과물을 생성합니다:

- 📄 **ACEN 매출결의서**: ACEN 데이터 기반 매출결의서
- 📄 **AICC 매출결의서**: 다중 AICC 파일 통합 처리
- 📊 **업무실적 보고서**: 전체 데이터 종합 실적 보고서
- 📦 **통합 ZIP 파일**: 모든 결과물을 포함한 압축파일

---

## 🚀 주요 기능

### 💻 웹 기반 인터페이스
- 브라우저에서 직접 접근 가능
- Bootstrap 기반 반응형 UI
- 직관적인 파일 업로드 및 처리

### 📂 스마트 파일 처리
- **ACEN**: 단일 엑셀 파일 처리
- **AICC**: 다중 파일 자동 통합 및 그룹핑
- 자동 데이터 검증 및 오류 처리

### ⚡ 자동화된 연산 처리
- openpyxl 기반 순수 Python 연산
- 템플릿 기반 자동 문서 생성
- 날짜 기반 자동 파일명 생성

### 📦 결과물 관리
- 연도/월별 자동 디렉토리 구성
- ZIP 파일로 통합 다운로드
- 처리 이력 관리

---

## 🛠️ 기술 스택

### 백엔드
- **Python 3.8+**
- **Flask 3.0.3**: 웹 프레임워크
- **pandas 2.2.2**: 데이터 처리
- **openpyxl 3.1.2**: 엑셀 파일 처리
- **python-dateutil**: 날짜 처리

### 프론트엔드
- **HTML5 + CSS3**
- **Bootstrap 5**: 반응형 UI
- **JavaScript**: 동적 UI 처리

### 배포
- **Gunicorn**: WSGI 서버

---

## 📁 프로젝트 구조

```
KT_auto_system_byOpenpyxl/
├── app.py                 # Flask 메인 애플리케이션
├── requirements.txt       # Python 의존성
├── .gitignore            # Git 무시 파일
├── services/             # 비즈니스 로직
│   ├── __init__.py
│   ├── acen.py          # ACEN 처리 로직
│   ├── aicc.py          # AICC 처리 로직
│   └── sum.py           # 업무실적 생성 로직
├── templates/           # 템플릿 파일
│   ├── index.html       # 메인 웹 페이지
│   └── *.xlsx          # 매출결의서 템플릿들
├── data/               # 샘플 데이터 (개발용)
│   └── *.xlsx          # 테스트용 데이터 파일들
└── output/             # 생성된 결과물
    └── 2025/
        └── 09/         # 연도/월별 구성
```

---

## ⚙️ 설치 및 실행

### 1. 가상환경 생성 (권장)
```bash
python -m venv venv
source venv/bin/activate      # macOS/Linux
venv\Scripts\activate         # Windows
```

### 2. 의존성 설치
```bash
pip install -r requirements.txt
```

### 3. 개발 서버 실행
```bash
python app.py
```

웹 브라우저에서 `http://localhost:5000` 접속

### 4. 프로덕션 배포
```bash
gunicorn -w 4 -b 0.0.0.0:5000 app:app
```

---

## 📖 사용법

1. **웹 브라우저 접속**: `http://localhost:5000`
2. **파일 업로드**:
   - ACEN 파일 (단일): `.xlsx` 파일 선택
   - AICC 파일 (다중): 여러 `.xlsx` 파일 선택
3. **처리 실행**: "처리 시작" 버튼 클릭
4. **결과 다운로드**: 처리 완료 후 ZIP 파일 다운로드

---

## 🔧 개발 히스토리

### v1.0의 한계점과 해결
1. **MS Office 의존성**: win32com → openpyxl 전환으로 해결
2. **배포 복잡성**: .exe 빌드 → 웹 기반 배포로 간소화
3. **사용성**: 로컬 설치 → 브라우저 접근으로 개선
4. **UI 복잡성**: threading/queue 기반 비동기 UI → 단순한 웹 기반 동기 처리

### v1.1의 핵심 개선사항
- 🌐 **접근성 향상**: 브라우저만 있으면 어디서든 사용 가능
- 🔧 **유지보수성**: 모듈화된 구조로 개발 효율성 증대
- 📈 **확장성**: 웹 기반으로 다중 사용자 지원 가능
- 🛡️ **안정성**: 순수 Python 구현으로 환경 의존성 최소화
- ⚡ **단순성**: 동기식 처리로 복잡한 스레딩 로직 제거

---

## 📝 라이선스

이 프로젝트는 사내 업무 자동화를 위한 내부 도구입니다.